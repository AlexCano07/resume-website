<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alex Cano // Terminal Resume</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #00ff99;
      --bg-color: #0f0f0f;
      --text-color: #00ff99;
      --border-color: #00ff99;
      --hover-bg: #00ff99;
      --hover-text: #0f0f0f;
      --transition-speed: 1s;
    }

    [data-theme="light"] {
      --primary-color: #0066cc;
      --bg-color: #f0f0f0;
      --text-color: #0066cc;
      --border-color: #0066cc;
      --hover-bg: #0066cc;
      --hover-text: #f0f0f0;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Press Start 2P', monospace;
      overflow: hidden;
      line-height: 1.6;
      font-size: 12px;
      transition: background-color var(--transition-speed), color var(--transition-speed);
    }

    /* Responsive font sizing */
    @media (min-width: 768px) {
      body { font-size: 14px; }
    }

    @media (min-width: 1024px) {
      body { font-size: 16px; }
    }

    .screen {
      padding: 1rem;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      transition: opacity var(--transition-speed);
    }

    /* Matrix rain canvas - positioned behind main content */
    .matrix-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.3;
      pointer-events: none;
      transition: opacity var(--transition-speed);
    }

    /* Reduce matrix opacity when transitioning sections */
    .screen.transitioning .matrix-canvas {
      opacity: 0.1;
    }

    @media (min-width: 768px) {
      .screen { padding: 2rem; }
    }

    .boot {
      animation: blink 1s steps(2, start) infinite;
      border-right: .1em solid var(--primary-color);
      white-space: nowrap;
      overflow: hidden;
      width: 100%;
      max-width: 300px;
      text-align: center;
      margin-bottom: 1rem;
    }

    @media (min-width: 768px) {
      .boot {
        width: 24ch;
        max-width: none;
      }
    }

    @keyframes blink {
      from, to { border-color: transparent }
      50% { border-color: var(--primary-color); }
    }

    @keyframes typewriter {
      from { width: 0; }
      to { width: 100%; }
    }

    .typing {
      animation: typewriter 2s steps(20, end), blink 1s steps(2, start) infinite;
    }

    nav {
      margin-top: 1rem;
      width: 100%;
      max-width: 300px;
    }

    @media (min-width: 768px) {
      nav {
        margin-top: 2rem;
        max-width: none;
      }
    }

    nav a {
      display: block;
      margin: 0.5rem 0;
      color: var(--text-color);
      text-decoration: none;
      font-size: 0.8em;
      border: 1px solid var(--border-color);
      padding: 0.5rem 1rem;
      transition: all var(--transition-speed);
      text-align: center;
      cursor: pointer;
      position: relative;
      outline: none;
    }

    @media (min-width: 768px) {
      nav a {
        margin: 1rem 0;
        font-size: 1em;
      }
    }

    nav a:hover,
    nav a:focus {
      background-color: var(--hover-bg);
      color: var(--hover-text);
      transform: scale(1.02);
    }

    nav a:focus {
      box-shadow: 0 0 0 2px var(--primary-color);
    }

    nav a:active {
      transform: scale(0.98);
    }

    .controls {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 1000;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .control-btn {
      background: var(--bg-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      padding: 0.25rem 0.5rem;
      font-family: inherit;
      font-size: 0.6em;
      cursor: pointer;
      transition: all var(--transition-speed);
    }

    .control-btn:hover,
    .control-btn:focus {
      background-color: var(--hover-bg);
      color: var(--hover-text);
    }

    section {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: var(--bg-color);
      padding: 1rem;
      overflow-y: auto;
      opacity: 0;
      transform: translateY(20px) scale(0.95);
      transition: all var(--transition-speed) ease-out;
      pointer-events: none;
    }

    @media (min-width: 768px) {
      section { padding: 2rem; }
    }

    section.active {
      opacity: 1;
      transform: translateY(0) scale(1);
      pointer-events: all;
    }

    section h1 {
      color: var(--primary-color);
      margin-bottom: 1rem;
      font-size: 1.2em;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.5rem;
    }

    @media (min-width: 768px) {
      section h1 { font-size: 1.5em; }
    }

    section p, section li {
      line-height: 1.8;
      margin-bottom: 1rem;
      font-size: 0.8em;
    }

    @media (min-width: 768px) {
      section p, section li { font-size: 1em; }
    }

    section ul {
      list-style: none;
      padding: 0;
    }

    section li::before {
      content: '> ';
      color: var(--primary-color);
    }

    .back-btn {
      position: fixed;
      bottom: 1rem;
      left: 1rem;
      background: var(--bg-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      padding: 0.5rem 1rem;
      font-family: inherit;
      font-size: 0.7em;
      cursor: pointer;
      transition: all var(--transition-speed);
      z-index: 100;
    }

    .back-btn:hover,
    .back-btn:focus {
      background-color: var(--hover-bg);
      color: var(--hover-text);
    }

    .keyboard-hint {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      font-size: 0.5em;
      opacity: 0.7;
      z-index: 100;
    }

    @media (min-width: 768px) {
      .keyboard-hint { font-size: 0.6em; }
    }

    /* Loading animation */
    .loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 9999;
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-speed);
    }

    .loading.show {
      opacity: 1;
    }

    /* Accessibility improvements */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
      :root {
        --primary-color: #ffffff;
        --bg-color: #000000;
        --text-color: #ffffff;
        --border-color: #ffffff;
      }
    }

    /* Focus indicators for keyboard navigation and accessibility */
    .screen:focus-within nav a:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    /* Make section headings focusable for accessibility */
    section h1[tabindex="-1"]:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    /* About section styling */
    .about-wrapper {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin-top: 1rem;
    }

    .pixel-avatar {
      width: 120px;
      height: auto;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
      border: 2px solid var(--border-color);
      border-radius: 4px;
      transition: all var(--transition-speed);
      flex-shrink: 0;
    }

    .pixel-avatar:hover {
      transform: scale(1.05);
      border-color: var(--primary-color);
      filter: brightness(1.1);
    }

    @media (min-width: 768px) {
      .pixel-avatar {
        width: 150px;
      }
      
      .about-wrapper {
        gap: 2rem;
      }
    }

    @media (max-width: 600px) {
      .about-wrapper {
        flex-direction: column;
        text-align: center;
        gap: 1rem;
      }

      .pixel-avatar {
        width: 100px;
      }
    }

    /* Error message styling */
    .error {
      color: #ff4444;
      font-size: 0.7em;
      margin-top: 1rem;
      opacity: 0;
      transition: opacity var(--transition-speed);
    }

    .error.show {
      opacity: 1;
    }

    /* Mobile-specific adjustments */
    @media (max-width: 767px) {
      .controls {
        top: 0.5rem;
        right: 0.5rem;
      }
      
      .back-btn {
        bottom: 0.5rem;
        left: 0.5rem;
        font-size: 0.6em;
        padding: 0.4rem 0.8rem;
      }
      
      .keyboard-hint {
        display: none;
      }
    }

    /* Print styles */
    @media print {
      body { 
        background: white; 
        color: black; 
        font-size: 12pt;
      }
      .controls, .back-btn, .keyboard-hint { 
        display: none; 
      }
      section { 
        position: static; 
        opacity: 1; 
        transform: none; 
        height: auto; 
        page-break-after: always; 
      }
    }
  </style>
</head>
<body>
  <div class="controls">
    <button class="control-btn" onclick="toggleTheme()" title="Toggle Theme">Theme</button>
    <button class="control-btn" onclick="toggleSound()" title="Toggle Sound" id="soundBtn">Sound: ON</button>
  </div>

  <div class="screen" id="mainScreen">
    <canvas class="matrix-canvas" id="matrixCanvas"></canvas>
    <div class="boot typing" id="bootText">>> Initializing Alex.exe</div>
    <nav role="navigation" aria-label="Main navigation">
      <a href="#about" onclick="showSection('about')" data-section="about" role="button" tabindex="0">> About</a>
      <a href="#skills" onclick="showSection('skills')" data-section="skills" role="button" tabindex="0">> Skills</a>
      <a href="#projects" onclick="showSection('projects')" data-section="projects" role="button" tabindex="0">> Projects</a>
      <a href="#contact" onclick="showSection('contact')" data-section="contact" role="button" tabindex="0">> Contact</a>
    </nav>
    <div class="error" id="errorMsg" role="alert" aria-live="polite"></div>
  </div>

  <div class="loading" id="loading">
    <div class="boot">>> Loading...</div>
  </div>

  <section id="about" role="main" aria-labelledby="about-heading">
    <h1 id="about-heading" tabindex="-1">About</h1>
    <div class="about-wrapper">
      <img src="neo-pixel.png" alt="Pixel Character Avatar" class="pixel-avatar">
      <p>I'm Alex, an IT professional, Business Analyst, and National Guard NCO who's all about building cool stuff. Whether it's tech, strategy, or a squad, I'm all in.</p>
    </div>
  </section>

  <section id="skills" role="main" aria-labelledby="skills-heading">
    <h1 id="skills-heading" tabindex="-1">Skills</h1>
    <ul>
      <li>HTML / CSS / JavaScript</li>
      <li>Python, R, SQL</li>
      <li>Hardware & Console Repair</li>
      <li>Data Analytics & Visualization</li>
      <li>AI Prompt Engineering</li>
    </ul>
  </section>

  <section id="projects" role="main" aria-labelledby="projects-heading">
    <h1 id="projects-heading" tabindex="-1">Projects</h1>
    <p>Jarvis+: A local AI assistant hosted on Linux<br>
    CARE Dashboard: Platform operations & EO tracker for State Dept<br>
    GameBoy SP RGB Mod: Full shell, IPS, and pixel-perfect nostalgia</p>
  </section>

  <section id="contact" role="main" aria-labelledby="contact-heading">
    <h1 id="contact-heading" tabindex="-1">Contact</h1>
    <p>Email: alexcano.dev@example.com<br>
    GitHub: github.com/alexcano<br>
    LinkedIn: linkedin.com/in/alexcano</p>
  </section>

  <button class="back-btn" onclick="goHome()" id="backBtn" style="display: none;" title="Back to main menu">< Back</button>
  <div class="keyboard-hint">Use ↑/↓ or W/S to navigate • ESC to go back</div>

  <script>
    // Application state
    let currentSection = null;
    let soundEnabled = true;
    let currentTheme = 'dark';
    let navigationIndex = 0;
    const sections = ['about', 'skills', 'projects', 'contact'];

    // Matrix rain variables
    let matrixCanvas = null;
    let matrixCtx = null;
    let matrixColumns = [];
    let matrixAnimationId = null;
    let matrixInitialized = false;

    // Audio context for sound effects
    let audioContext = null;

    // Initialize application
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
      setupKeyboardNavigation();
      setupAccessibility();
      initializeMatrix();
    });

    function initializeApp() {
      try {
        // Initialize audio context on first user interaction
        document.addEventListener('click', initAudioContext, { once: true });
        document.addEventListener('keydown', initAudioContext, { once: true });

        // Add typing animation to boot text
        setTimeout(() => {
          const bootText = document.getElementById('bootText');
          if (bootText) {
            bootText.classList.add('typing');
          }
        }, 500);

        // Preload sections for smooth transitions
        preloadSections();

      } catch (error) {
        handleError('Failed to initialize application', error);
      }
    }

    function initAudioContext() {
      if (!audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function playSound(frequency = 800, duration = 100, type = 'sine') {
      if (!soundEnabled || !audioContext) return;

      try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();

        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);

        oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
        oscillator.type = type;

        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration / 1000);

        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration / 1000);
      } catch (error) {
        console.warn('Sound playback failed:', error);
      }
    }

    function showSection(sectionId) {
      try {
        // Validate section ID
        if (!sectionId || !sections.includes(sectionId)) {
          throw new Error(`Invalid section ID: ${sectionId}`);
        }

        // Don't transition if already active
        if (currentSection === sectionId) {
          return;
        }

        // Show loading indicator
        showLoading();

        // Play navigation sound
        playSound(600, 150);

        // Hide main screen
        const mainScreen = document.getElementById('mainScreen');
        if (mainScreen) {
          mainScreen.style.opacity = '0';
          mainScreen.classList.add('transitioning');
        }

        // Pause matrix animation during section transition for performance
        stopMatrixAnimation();

        // Simulate loading time for smooth UX
        setTimeout(() => {
          // Hide all sections
          document.querySelectorAll('section').forEach(sec => {
            sec.classList.remove('active');
            sec.setAttribute('aria-hidden', 'true');
          });

          // Show target section
          const targetSection = document.getElementById(sectionId);
          if (targetSection) {
            targetSection.classList.add('active');
            targetSection.setAttribute('aria-hidden', 'false');
            
            // Focus management for accessibility
            const heading = targetSection.querySelector('h1');
            if (heading) {
              heading.focus();
            }
          }

          // Update navigation state
          currentSection = sectionId;
          navigationIndex = sections.indexOf(sectionId);

          // Show back button
          const backBtn = document.getElementById('backBtn');
          if (backBtn) {
            backBtn.style.display = 'block';
          }

          // Hide loading indicator
          hideLoading();

          // Update URL without page reload
          updateURL(sectionId);

        }, 200);

      } catch (error) {
        handleError('Failed to show section', error);
        hideLoading();
      }
    }

    /* ========================================
     * MATRIX DIGITAL RAIN IMPLEMENTATION
     * ======================================== */

    /**
     * Initialize the Matrix digital rain effect
     * Sets up canvas, calculates columns, and starts animation
     */
    function initializeMatrix() {
      try {
        // Get canvas element and validate it exists
        matrixCanvas = document.getElementById('matrixCanvas');
        if (!matrixCanvas) {
          console.warn('Matrix canvas not found');
          return;
        }

        // Get 2D rendering context
        matrixCtx = matrixCanvas.getContext('2d');
        if (!matrixCtx) {
          console.warn('Matrix canvas context not available');
          return;
        }

        // Set up responsive canvas sizing
        resizeMatrixCanvas();

        // Initialize matrix columns array
        setupMatrixColumns();

        // Start the animation loop
        startMatrixAnimation();

        // Handle window resize for responsive behavior
        window.addEventListener('resize', debounce(resizeMatrixCanvas, 250));

        matrixInitialized = true;
        console.log('Matrix rain initialized successfully');

      } catch (error) {
        console.error('Failed to initialize Matrix rain:', error);
        // Gracefully degrade - application still works without Matrix effect
      }
    }

    /**
     * Resize canvas to match screen dimensions and pixel density
     * Ensures crisp rendering on high-DPI displays
     */
    function resizeMatrixCanvas() {
      if (!matrixCanvas || !matrixCtx) return;

      try {
        // Get actual display size
        const rect = matrixCanvas.getBoundingClientRect();
        const devicePixelRatio = window.devicePixelRatio || 1;

        // Set canvas internal size (for drawing)
        matrixCanvas.width = rect.width * devicePixelRatio;
        matrixCanvas.height = rect.height * devicePixelRatio;

        // Scale canvas back down using CSS for crisp rendering
        matrixCanvas.style.width = rect.width + 'px';
        matrixCanvas.style.height = rect.height + 'px';

        // Scale drawing context to match device pixel ratio
        matrixCtx.scale(devicePixelRatio, devicePixelRatio);

        // Recalculate columns after resize
        setupMatrixColumns();

      } catch (error) {
        console.error('Failed to resize matrix canvas:', error);
      }
    }

    /**
     * Set up matrix columns based on canvas width
     * Each column represents a vertical stream of characters
     */
    function setupMatrixColumns() {
      if (!matrixCanvas) return;

      try {
        // Calculate optimal column width for readability
        const fontSize = Math.max(10, Math.min(16, matrixCanvas.width / 80));
        const columnWidth = fontSize * 0.8;
        const numColumns = Math.floor(matrixCanvas.width / columnWidth);

        // Reset columns array
        matrixColumns = [];

        // Initialize each column with random properties
        for (let i = 0; i < numColumns; i++) {
          matrixColumns[i] = {
            x: i * columnWidth,
            y: Math.random() * -matrixCanvas.height, // Start above screen
            speed: Math.random() * 3 + 1, // Random fall speed
            length: Math.random() * 20 + 5, // Random trail length
            characters: [], // Character trail array
            fontSize: fontSize,
            opacity: Math.random() * 0.5 + 0.3 // Random opacity variation
          };
        }

      } catch (error) {
        console.error('Failed to setup matrix columns:', error);
      }
    }

    /**
     * Start the matrix animation loop
     * Uses requestAnimationFrame for smooth 60fps animation
     */
    function startMatrixAnimation() {
      if (!matrixInitialized || !matrixCtx) return;

      try {
        // Cancel any existing animation
        if (matrixAnimationId) {
          cancelAnimationFrame(matrixAnimationId);
        }

        // Start new animation loop
        matrixAnimationId = requestAnimationFrame(animateMatrix);

      } catch (error) {
        console.error('Failed to start matrix animation:', error);
      }
    }

    /**
     * Stop the matrix animation
     * Used for performance optimization when not needed
     */
    function stopMatrixAnimation() {
      if (matrixAnimationId) {
        cancelAnimationFrame(matrixAnimationId);
        matrixAnimationId = null;
      }
    }

    /**
     * Main animation loop for matrix rain effect
     * Updates and renders all matrix columns
     */
    function animateMatrix() {
      if (!matrixCtx || !matrixCanvas) return;

      try {
        // Clear canvas with fade effect for trailing
        matrixCtx.fillStyle = 'rgba(15, 15, 15, 0.1)'; // Semi-transparent background
        matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);

        // Update and render each column
        matrixColumns.forEach((column, index) => {
          updateMatrixColumn(column, index);
          renderMatrixColumn(column);
        });

        // Continue animation loop
        matrixAnimationId = requestAnimationFrame(animateMatrix);

      } catch (error) {
        console.error('Matrix animation error:', error);
        // Stop animation on error to prevent console spam
        stopMatrixAnimation();
      }
    }

    /**
     * Update a single matrix column's position and characters
     * @param {Object} column - Column object to update
     * @param {number} index - Column index for consistent randomization
     */
    function updateMatrixColumn(column, index) {
      try {
        // Move column down
        column.y += column.speed;

        // Reset column when it's completely off screen
        if (column.y > matrixCanvas.height + column.length * column.fontSize) {
          column.y = Math.random() * -200 - 100; // Random delay before restart
          column.speed = Math.random() * 3 + 1; // New random speed
          column.length = Math.random() * 20 + 5; // New random length
          column.opacity = Math.random() * 0.5 + 0.3; // New opacity
        }

        // Update character trail
        updateColumnCharacters(column, index);

      } catch (error) {
        console.error('Failed to update matrix column:', error);
      }
    }

    /**
     * Update the character trail for a column
     * @param {Object} column - Column to update
     * @param {number} index - Column index for seeded randomization
     */
    function updateColumnCharacters(column, index) {
      try {
        // Matrix-style characters (mix of katakana, numbers, and symbols)
        const matrixChars = 'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&*()';

        // Add new character at head of trail
        if (column.characters.length === 0 || Math.random() > 0.7) {
          const randomChar = matrixChars[Math.floor(Math.random() * matrixChars.length)];
          column.characters.unshift({
            char: randomChar,
            brightness: 1.0
          });
        }

        // Fade and remove old characters
        column.characters = column.characters
          .map(charObj => ({
            ...charObj,
            brightness: charObj.brightness * 0.95 // Gradual fade
          }))
          .filter(charObj => charObj.brightness > 0.1) // Remove very faded chars
          .slice(0, column.length); // Limit trail length

        // Occasionally change characters for dynamic effect
        column.characters.forEach(charObj => {
          if (Math.random() > 0.98) {
            charObj.char = matrixChars[Math.floor(Math.random() * matrixChars.length)];
          }
        });

      } catch (error) {
        console.error('Failed to update column characters:', error);
      }
    }

    /**
     * Render a single matrix column to the canvas
     * @param {Object} column - Column to render
     */
    function renderMatrixColumn(column) {
      if (!matrixCtx) return;

      try {
        // Set font properties
        matrixCtx.font = `${column.fontSize}px 'Press Start 2P', monospace`;
        matrixCtx.textAlign = 'left';

        // Render each character in the trail
        column.characters.forEach((charObj, charIndex) => {
          const charY = column.y + (charIndex * column.fontSize);

          // Skip rendering if character is off-screen
          if (charY < -column.fontSize || charY > matrixCanvas.height + column.fontSize) {
            return;
          }

          // Calculate color based on theme and character brightness
          const baseColor = currentTheme === 'dark' ? '0, 255, 153' : '0, 102, 204';
          const alpha = charObj.brightness * column.opacity;

          // Brighten the leading character
          const isLeadingChar = charIndex === 0;
          const finalAlpha = isLeadingChar ? Math.min(alpha * 1.5, 1.0) : alpha;

          // Set character color
          matrixCtx.fillStyle = `rgba(${baseColor}, ${finalAlpha})`;

          // Add glow effect for leading characters
          if (isLeadingChar && finalAlpha > 0.8) {
            matrixCtx.shadowColor = `rgba(${baseColor}, ${finalAlpha})`;
            matrixCtx.shadowBlur = column.fontSize * 0.3;
          } else {
            matrixCtx.shadowBlur = 0;
          }

          // Render the character
          matrixCtx.fillText(charObj.char, column.x, charY);
        });

        // Reset shadow for next column
        matrixCtx.shadowBlur = 0;

      } catch (error) {
        console.error('Failed to render matrix column:', error);
      }
    }

    /**
     * Debounce function to limit resize event frequency
     * @param {Function} func - Function to debounce
     * @param {number} wait - Wait time in milliseconds
     * @returns {Function} Debounced function
     */
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    /* ========================================
     * END MATRIX IMPLEMENTATION
     * ======================================== */

    function goHome() {
      try {
        playSound(500, 150);
        
        showLoading();

        setTimeout(() => {
          // Hide all sections
          document.querySelectorAll('section').forEach(sec => {
            sec.classList.remove('active');
            sec.setAttribute('aria-hidden', 'true');
          });

          // Show main screen
          const mainScreen = document.getElementById('mainScreen');
          if (mainScreen) {
            mainScreen.style.opacity = '1';
          }

          // Hide back button
          const backBtn = document.getElementById('backBtn');
          if (backBtn) {
            backBtn.style.display = 'none';
          }

          // Reset state
          currentSection = null;
          navigationIndex = 0;

          // Focus first navigation link
          const firstNavLink = document.querySelector('nav a');
          if (firstNavLink) {
            firstNavLink.focus();
          }

          hideLoading();
          updateURL('');

        }, 200);

      } catch (error) {
        handleError('Failed to go home', error);
        hideLoading();
      }
    }

    function setupKeyboardNavigation() {
      document.addEventListener('keydown', function(e) {
        try {
          switch(e.key) {
            case 'Escape':
              if (currentSection) {
                e.preventDefault();
                goHome();
              }
              break;

            case 'ArrowUp':
            case 'w':
            case 'W':
              if (currentSection) {
                e.preventDefault();
                navigateSection(-1);
              } else {
                e.preventDefault();
                navigateMenu(-1);
              }
              break;

            case 'ArrowDown':
            case 's':
            case 'S':
              if (currentSection) {
                e.preventDefault();
                navigateSection(1);
              } else {
                e.preventDefault();
                navigateMenu(1);
              }
              break;

            case 'Enter':
            case ' ':
              if (!currentSection) {
                e.preventDefault();
                const activeLink = document.querySelector(`nav a:nth-child(${navigationIndex + 1})`);
                if (activeLink) {
                  const sectionId = activeLink.getAttribute('data-section');
                  showSection(sectionId);
                }
              }
              break;
          }
        } catch (error) {
          handleError('Keyboard navigation error', error);
        }
      });
    }

    function navigateSection(direction) {
      const newIndex = (navigationIndex + direction + sections.length) % sections.length;
      showSection(sections[newIndex]);
    }

    function navigateMenu(direction) {
      navigationIndex = (navigationIndex + direction + sections.length) % sections.length;
      
      // Update visual focus
      document.querySelectorAll('nav a').forEach((link, index) => {
        if (index === navigationIndex) {
          link.focus();
        }
      });

      playSound(700, 80);
    }

    function toggleTheme() {
      try {
        currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', currentTheme);
        
        // Update matrix colors to match new theme
        if (matrixInitialized) {
          // Matrix will automatically use new theme colors on next render
        }
        
        playSound(900, 100);
      } catch (error) {
        handleError('Failed to toggle theme', error);
      }
    }

    function toggleSound() {
      try {
        soundEnabled = !soundEnabled;
        const soundBtn = document.getElementById('soundBtn');
        if (soundBtn) {
          soundBtn.textContent = `Sound: ${soundEnabled ? 'ON' : 'OFF'}`;
        }
        
        if (soundEnabled) {
          playSound(800, 100);
        }
      } catch (error) {
        handleError('Failed to toggle sound', error);
      }
    }

    function setupAccessibility() {
      // Add ARIA labels and roles
      document.querySelectorAll('nav a').forEach((link, index) => {
        link.setAttribute('aria-label', `Navigate to ${sections[index]} section`);
        
        // Handle both click and keyboard activation
        link.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            const sectionId = this.getAttribute('data-section');
            showSection(sectionId);
          }
        });
      });

      // Announce section changes to screen readers
      const announcer = document.createElement('div');
      announcer.setAttribute('aria-live', 'polite');
      announcer.setAttribute('aria-atomic', 'true');
      announcer.style.position = 'absolute';
      announcer.style.left = '-10000px';
      announcer.style.width = '1px';
      announcer.style.height = '1px';
      announcer.style.overflow = 'hidden';
      document.body.appendChild(announcer);

      // Store reference for later use
      window.screenReaderAnnouncer = announcer;
    }

    function announceToScreenReader(message) {
      if (window.screenReaderAnnouncer) {
        window.screenReaderAnnouncer.textContent = message;
      }
    }

    function preloadSections() {
      // Pre-render sections for smooth transitions
      sections.forEach(sectionId => {
        const section = document.getElementById(sectionId);
        if (section) {
          section.style.display = 'block';
          section.offsetHeight; // Force layout calculation
          section.style.display = '';
        }
      });
    }

    function showLoading() {
      const loading = document.getElementById('loading');
      if (loading) {
        loading.classList.add('show');
      }
    }

    function hideLoading() {
      const loading = document.getElementById('loading');
      if (loading) {
        loading.classList.remove('show');
      }
    }

    function updateURL(sectionId) {
      try {
        const url = sectionId ? `#${sectionId}` : '';
        window.history.replaceState({ section: sectionId }, '', url);
      } catch (error) {
        // URL update failed, but not critical
        console.warn('Failed to update URL:', error);
      }
    }

    function handleError(message, error) {
      console.error(message, error);
      
      const errorMsg = document.getElementById('errorMsg');
      if (errorMsg) {
        errorMsg.textContent = 'System error detected. Please refresh the page.';
        errorMsg.classList.add('show');
        
        setTimeout(() => {
          errorMsg.classList.remove('show');
        }, 5000);
      }

      // Play error sound
      playSound(300, 200, 'square');
    }

    // Handle browser back/forward buttons
    window.addEventListener('popstate', function(e) {
      const sectionId = e.state?.section;
      if (sectionId && sections.includes(sectionId)) {
        showSection(sectionId);
      } else {
        goHome();
      }
    });

    // Handle direct URL access
    window.addEventListener('load', function() {
      const hash = window.location.hash.substring(1);
      if (hash && sections.includes(hash)) {
        setTimeout(() => showSection(hash), 500); // Reduced delay for better UX
      }
    });

    // Graceful degradation for no-JS users
    document.documentElement.classList.add('js-enabled');

    // Performance optimization: cleanup on page unload
    window.addEventListener('beforeunload', function() {
      // Clean up matrix animation
      stopMatrixAnimation();
      
      // Clean up audio context safely
      if (audioContext && audioContext.state !== 'closed') {
        audioContext.close().catch(() => {
          // Silently handle any close errors - not critical during page unload
        });
      }
    });

    // Pause matrix animation when page is not visible for performance
    document.addEventListener('visibilitychange', function() {
      if (document.hidden) {
        stopMatrixAnimation();
      } else if (matrixInitialized && !currentSection) {
        startMatrixAnimation();
      }
    });


  </script>

  <noscript>
    <style>
      .screen { display: none; }
      section { 
        display: block !important; 
        position: static !important; 
        opacity: 1 !important; 
        transform: none !important; 
        height: auto !important; 
        margin-bottom: 2rem;
      }
      .controls, .back-btn, .keyboard-hint { display: none; }
    </style>
  </noscript>
</body>
</html>
